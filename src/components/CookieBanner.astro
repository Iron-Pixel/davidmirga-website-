---
// Cookie Banner f√ºr DSGVO-Konformit√§t (√ñsterreich)
// FINAL FIX: CLS und TBT-Probleme behoben
---

<div 
  id="cookie-banner" 
  class="fixed bottom-0 left-0 right-0 bg-brand-navy text-white p-6 shadow-2xl z-50 transform translate-y-full transition-transform duration-500"
>
  <div class="container max-w-5xl flex flex-col md:flex-row items-center justify-between gap-6">
    <div class="flex-1">
      <h3 class="font-bold text-lg mb-2">üç™ Diese Website verwendet Cookies</h3>
      <p class="text-sm text-slate-300 leading-relaxed">
        Wir verwenden technisch notwendige Cookies, um die Funktionalit√§t dieser Website zu gew√§hrleisten. 
        Durch die weitere Nutzung stimmen Sie der Verwendung von Cookies gem√§√ü unserer 
        <a href="/datenschutz" class="underline hover:text-brand-red">Datenschutzerkl√§rung</a> zu.
      </p>
    </div>
    <div class="flex gap-4">
      <button 
        id="cookie-accept"
        aria-label="Alle Cookies und Tracking akzeptieren"
        class="px-6 py-3 bg-brand-red text-white font-bold rounded hover:bg-red-700 transition-colors whitespace-nowrap"
      >
        Alle akzeptieren
      </button>
      <button 
        id="cookie-decline"
        aria-label="Nur technisch notwendige Cookies akzeptieren"
        class="px-6 py-3 bg-white/10 text-white font-bold rounded hover:bg-white/20 transition-colors whitespace-nowrap"
      >
        Nur notwendige
      </button>
    </div>
  </div>
</div>

<script>
  // Der gesamte JavaScript-Code wird asynchron geladen, um TBT zu eliminieren.
  // CLS-Problem wird behoben, da die Position des Banners schon im CSS definiert ist.
  document.addEventListener('DOMContentLoaded', () => {
    const banner = document.getElementById('cookie-banner');
    const acceptBtn = document.getElementById('cookie-accept');
    const declineBtn = document.getElementById('cookie-decline');

    const cookieConsent = localStorage.getItem('cookieConsent');

    function hideBanner() {
      if (banner) {
        banner.classList.add('translate-y-full');
        // Erst nach der CSS-Animation komplett aus dem Layout entfernen
        setTimeout(() => {
          banner.remove(); 
        }, 500); 
      }
    }

    if (!cookieConsent) {
      // Banner anzeigen nach 1 Sekunde (Verz√∂gerung f√ºr besseren FCP)
      setTimeout(() => {
        if (banner) {
          // CLS FIX: F√§hrt von translate-y-full (unten) nach oben
          banner.classList.remove('translate-y-full');
        }
      }, 1000);
    } else if (banner) {
      // Wenn bereits entschieden, Banner sofort entfernen
      banner.remove();
      return;
    }

    // Accept Handler
    acceptBtn?.addEventListener('click', () => {
      localStorage.setItem('cookieConsent', 'accepted');
      hideBanner();
    });

    // Decline Handler
    declineBtn?.addEventListener('click', () => {
      localStorage.setItem('cookieConsent', 'declined');
      hideBanner();
    });
  });
</script>